<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        {% load static %}
        <link rel="stylesheet" href="{% static 'css/signup.css' %}" />
        <link
            rel="stylesheet"
            as="style"
            crossorigin
            href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable.min.css"
        />
        <title>Beewalk</title>
    </head>
    <body>
        <form method="post" enctype="multipart/form-data" id="signupForm" action="{% url 'accountapp:login' %}">
            {% csrf_token %}

            <div class="photo">
                <img
                    class="upload"
                    src="{% static 'img/plus.png' %}"
                    onclick="document.getElementById('profile').click();"
                    style="cursor: pointer"
                />
                <img id="photo_img" src="" />
            </div>

            <div class="email">
                <div class="email_text">
                    <p>{{ form.email.label }}</p>
                    <p id="email_check_success"></p>
                </div>
                <div class="email_input">{{ form.email }}</div>
            </div>

            <div class="password">
                <div class="password_text">
                    <p>{{ form.password.label }}</p>
                    <p id="password_check_success"></p>
                </div>
                {{ form.password }}
                <input
                    type="password"
                    name="checkpwd"
                    id="checkpwd"
                    style="margin-top: 10px"
                    placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ í•œ ë²ˆ ë” ì…ë ¥í•´ì£¼ì„¸ìš”"
                />
            </div>

            <div class="username">
                <div class="username_text">
                    <p>{{ form.username.label }}</p>
                    <p id="username_check_success"></p>
                </div>
                <div class="username_input">{{ form.username }}</div>
            </div>

            <button type="submit" id="submit_button">íšŒì›ê°€ì… í•˜ê¸°</button>
        </form>
    </body>
    <script>
        function previewImage(event) {
            const file = event.target.files[0];
            const reader = new FileReader();
            reader.onload = function () {
                const preview = document.getElementById("photo_img");
                preview.src = reader.result;
                preview.style.display = "block";
            };
            if (file) {
                reader.readAsDataURL(file);
            }
        }
        // HTML ìš”ì†Œë“¤ì„ ê°€ì ¸ì˜¤ê¸°
        const emailInput = document.querySelector('input[name="email"]');
        const passwordInput = document.querySelector('input[name="password"]');
        const checkpwdInput = document.querySelector('input[name="checkpwd"]');
        const usernameInput = document.querySelector('input[name="username"]');
        const submitButton = document.querySelector("#submit_button");
        const passwordCheckSuccess = document.querySelector("#password_check_success");

        // ëª¨ë“  ì…ë ¥ í•„ë“œê°€ ì…ë ¥ë  ë•Œì˜ ìƒíƒœë¥¼ ì¶”ì í•  ë³€ìˆ˜
        let isEmailFilled = false;
        let isPasswordFilled = false;
        let isCheckpwdFilled = false;
        let isUsernameFilled = false;

        // ê° ì…ë ¥ í•„ë“œì˜ ì…ë ¥ì„ ê°ì§€í•˜ê³  ìƒíƒœ ì—…ë°ì´íŠ¸
        emailInput.addEventListener("input", function () {
            isEmailFilled = emailInput.value.trim() !== ""; // ë‚´ìš©ì´ ë¹„ì–´ ìˆì§€ ì•Šìœ¼ë©´ true
            toggleButton();
        });

        passwordInput.addEventListener("input", function () {
            isPasswordFilled = passwordInput.value.trim() !== "";
            checkPasswordMatch();
            toggleButton();
        });

        checkpwdInput.addEventListener("input", function () {
            isCheckpwdFilled = checkpwdInput.value.trim() !== "";
            checkPasswordMatch();
            toggleButton();
        });

        usernameInput.addEventListener("input", function () {
            isUsernameFilled = usernameInput.value.trim() !== "";
            toggleButton();
        });

        // ë¹„ë°€ë²ˆí˜¸ ì¼ì¹˜ ì—¬ë¶€ë¥¼ ì²´í¬í•˜ëŠ” í•¨ìˆ˜
        function checkPasswordMatch() {
            const password = passwordInput.value.trim();
            const checkpwd = checkpwdInput.value.trim();
            if (password === checkpwd) {
                passwordCheckSuccess.innerText = ""; // ì¼ì¹˜í•˜ë©´ ë©”ì‹œì§€ë¥¼ ì´ˆê¸°í™”
            } else {
                passwordCheckSuccess.innerText = "ğŸš« ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤";
            }
        }

        // ë²„íŠ¼ ìƒíƒœë¥¼ ë³€ê²½í•˜ëŠ” í•¨ìˆ˜
        function toggleButton() {
            // ëª¨ë“  ì…ë ¥ í•„ë“œê°€ ì±„ì›Œì ¸ ìˆëŠ”ì§€ í™•ì¸
            const allFieldsFilled = isEmailFilled && isPasswordFilled && isCheckpwdFilled && isUsernameFilled;

            // ë²„íŠ¼ì˜ í´ë˜ìŠ¤ë¥¼ ì¡°ì‘í•˜ì—¬ ìŠ¤íƒ€ì¼ì„ ë³€ê²½
            if (allFieldsFilled) {
                submitButton.classList.add("enabled");
            } else {
                submitButton.classList.remove("enabled");
            }
        }
    </script>
</html>
